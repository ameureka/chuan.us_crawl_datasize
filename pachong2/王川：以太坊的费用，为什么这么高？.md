本文最初于 2021 年 2月26日发布于笔者的微信公众号。
1/ 以太坊 (Ethereum) 是比特币之后，市值第二大的公链。以太坊网络上每天产生一百多万笔交易，过去七天链上日均交易费用超过三千万美元（比特币相应的数据是八百万），过去三十天链上日均清算金额超过九十亿美元。
2/ 以太坊网络上的不同操作，传输数据大小不一样，消耗费用也不一样。以太坊的交易费用计算，主要由两个概念相乘而得，一个是燃气价格( gas price), 一个是燃气限额 (gas limit). 二者相乘，就得出用“以太币”(Ether)为单位的交易费用。
3/ 燃气价格单位为gwei, 相当于十亿分之一个以太币(十的负九次方）。燃气限额，最简单的发送以太币的操作也要 21000，更复杂的操作，尤其是涉及到智能合约，又要高几倍。每一个块，所有交易的燃气限额的总和也有上限，目前不能超过一千两百五十万（所以以太坊上每个区块，理论上最多只能有 595 笔交易），类似于比特币的区块大小的限制。
4/ Gas price 随着网络拥堵的程度而动态变化，2020年之前大部分时候都在20 gwei 以下，2020年上半年在 DeFi 火热之前，大部分时候都在 50 gwei 以下。进入 2021年以后，随着更多人的加入参与，每天最挤的时候价格可以超过400 gwei。
5/ 最便宜的，发送以太币 (eth) 的操作, 按照etherscan.io 二月二十四号的数据，目前费用大概在 0.00294eth ( 140 gwei 乘以 21000 ） 左右，按照以太币 1600 美元的价格也就大概不到五美元。
6/ 如果要传送 erc20 token, 因为涉及到更多的数据的读写和计算，费用一般至少三倍以上，目前大约十五美元左右。
7/ 如果要用uniswap 这样的智能合约做交易，换成别的 token, 那就更复杂了，目前一笔交易的以太 gas 费用是基本操作的十倍以上，在 40-70美元之间。
8/ uniswap,1inchexhcange,sushiswap,balancer 等等撮合token交易的智能合约，消耗了网络上超过20%的流量，是目前以太网络拥堵，费用高企不下的最重要原因之一。
9/ 可以把uniswap 这些智能合约看成一个完全开放的国际倒爷做买卖的贸易自由港。但区别是不用像过去那样，拎着大包小包，风餐露宿，过关斩将的做买卖。没有四海奔波的皮肉之苦，没有存货和资金周转的挑战，基本就是在家里点击一下鼠标，就可完成操作, 几分钟内获得清算的确认。
10/ 从这个角度看，70美元的gas 费用其实不贵。如果嫌贵，那是因为你做的生意太小。如果大家都嫌贵，上一次当后也就不会再去了。但为什么还有其他很多人每天前赴后继进行各种操作，承受上百美元的单笔交易费用，他们是在做慈善，是在赔本赚吆喝，还是在闷声大发财呢？可以参见笔者的老文章 “王川: 出钱最多者的视角，才是上帝视角”。
11/ 首先需要理解的是，gas 费用不是固定, 而是动态变化的，如果费用暂时上涨，这是市场给所有人发布的一个信号：我们这里需求太旺盛了，快来人满足我们的需求呀！
12/ 遇到价格上涨时，通常大户是无感的。毕竟，真正推动价格上涨的，是这些人狠话不多的大户。抱怨声音最大的，往往是小散，”以太坊太挤了，挤得都没人用了! 这里房价太贵了，贵得都没人住了！”. 然后他们会去寻找阻力最小的减少痛苦的方案。
13/ 这时候，如果某个中心化的交易所也做区块链，以牺牲去中心化的代价，提供极低的交易费用，同时几乎零成本的照抄以太坊上所有新生的应用代码和工具，把自己包装为以太杀手，对于想省钱的小散，非常有诱惑力。因为短期内，挖矿确实似乎可以赚些钱。最后能否盈利先不管，至少不用像以太坊上面，上来就支付几十美元，上百美元的让人肉疼的交易费了。
14/ 虽然有以太溢出的流量和中心化交易所的扶持，这类只有二十多个全节点的中心化备胎链，在生态复杂度和流动性深度上，仍然和以太有实质差别。而如果像瑞波币 (xrp) 一样，被证监会找茬，则可能面临流量突然下跌的风险。
15/ 真正去中心化平台上的的智能合约，如uniswap，是无法被封的。Uniswap 的创始人 Hayden Adams 同学曾表示，即使哪一天，监管机构叫他关掉 uniswap, 他对所有用户振臂高呼，“你们都不要用 uniswap 了！” 也无济于事。因为，部署在 0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D 地址上的 Uniswap V2: Router 2 本质已经是一排不能被包括原作者在内的任何人篡改的代码。
16/ 以太坊的抄袭者，生态复杂度相对于以太永远有欠缺。这里生态复杂度的内涵包括：链上的各种代币资产，wrapped btc, 各类智能合约，各类软件开发工具，流动性深度，开发者社区，等等，缺一不可。交易费用再低，如果生态复杂度低，有些事情是根本无法办成的。这就像乡下空气再好，物价再便宜，生病要做大手术时，还得回到市中心大医院。而当以太坊主链交易费用周期性下跌，新的机会复现时，唯利是图的流量，还是会随时回归以太主链的。
17/ 当年比特币网络费用下降的解决方法，很大程度上来自于交易所之间转币改为批处理(batch processing),相当于几十个人同坐一辆公交车。但以太坊做批处理就没有那么简单，多个不同 token 送到不同地址，必须用智能合约，智能合约比普通交易更复杂耗费gas多好几倍，很多时候无法真正节约费用。涉及到自动做市商交易的智能合约，要做批处理，就更复杂了。
18/ Rollup, 本质上就是以太坊上一种新的批处理技术，是在以太坊 2.0 分片技术真正部署之前，最有期望有效扩容的二层解决方案（以太主网相当于第一层），理论上可以把单笔交易消耗的gas费用降到原来的百分之一以下。Rollup 又分两种风格，optimistic rollup, 技术实现更简单，因为是先上车后查票，但需要等待一周才能提币到主链上；zk rollup, 技术实现更复杂，但无需等待可以马上提币。
19/ 各种 rollup 的项目过去两年不断浮现，究竟谁最终能对以太主网的扩展性产生实质性影响，各类钱包软件是否可以迅速把新项目的新功能整合进去，各种白皮书里的文宣究竟能兑现多少，现在还难下定论。下面列出几个在业内比较高调的项目。
– Optimism: 有知名风投公司 a16z 去年投资两千五百万美元，一月中旬已经在以太主网开始所谓软启动，并有做合成资产的去中心化交易所 Synthetix 合作参与。 – Uniswap v3: 有猜测会在今年三季度甚至更早推出，据说采用 optimistic rollup 方案。因为 uniswap 交易所流动性最深，如果推出，这可能是最有希望迅速降低以太主网费用的项目。 – Polygon：原名叫 Matic.network， 号称要做各种二层解决方案的聚合器，具体上线时间不详。 – Loopring （路印协议）: 2020 年三月上线的支持 zk-rollup 技术的交易所，但迄今为止日均交易量不超过两千万美元（原始数据来自 coingecko.com)
20/ 可以把 rollup 这类项目，看成是在拥挤的都市内修建地铁。每一个 rollup的二层解决方案，就好像居民自发筹资修建的地铁线。但一条线路不可能马上缓解整个都市的交通拥堵，rollup项目被市场的接受度也需要时间来验证。不同的二层解决方案之间，还需要搭建不经过主网的快速连接的桥梁（cross-rollup transaction)，正如不同地铁线路之间，要修建地下通道方便旅客换乘不同的线路。以上海地铁系统为例，从1993年到现在28年，累计开通了19条线路。可以想象，以太网络上各种提高扩展性的项目，将会是个长期的努力。
21/ 如果以史为鉴，以太坊上费用高的挑战，不可能有灵丹妙药一下子全部彻底解决，在以太坊 2.0 成功部署之前，一个可能发展路径是：
— 不断自发涌现的某个二层 rollup 解决方案，降低了某个局部环节的交易费用，吸引更多流量进入以太坊，促进生态的复杂化。
— 因为这些新流量涌入，以太坊上某个应用成为新的瓶颈，网络费用重新暴涨，流量又溢出部分，到其它中心化的备胎公链。
— 大户闷声发财，小散大声抱怨，舆论重新开始悲观，备胎公链市值上涨 （类似郊区房价涨幅在某个时期超过市中心的房价涨幅），并把自己包装为以太杀手来吸引流量。
— 新的二层解决方案又在以太网上涌现，以太费用回落，流量重新回归以太，其生态进一步复杂化，和备胎公链的实质生态复杂度的差别继续拉大。
22/ 以太坊网络上的费用，相对于其它备胎公链而言，将会长期保持费用偏高的格局。就像上海市中心的房价，永远比郊区如嘉定或奉贤的价格要高. 而世间，永远有隐约的耳语，散布着”房价太贵没人住”的传说。
